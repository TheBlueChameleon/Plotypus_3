#include "dataview.h"

using namespace Plotypus;

namespace Plotypus
{
    DataView::DataView(const PlotStyle style, const std::string& label) :
        title(label)
    {
        setStyleID(style);
    }

    DataView::DataView(const std::string& style, const std::string& label) :
        title(label), style(style), styleID(PlotStyle::Custom)
    {}

    void DataView::reset()
    {
        styleID                     = PlotStyle::Custom;
        styleFamily                 = PlotStyleFamily::Undefined;
        title                       = "";
        style                       = "lines";
        options                     = "";
        dataFilename                = "";
        numberPrecision             = -1;
        columnSeparatorTxt          = "\t";
        columnSeparatorDat          = "\t";
        binaryDataOutput            = true;
        autoGenerateDataFilename    = true;
    }

    const std::string& DataView::getTitle() const
    {
        return title;
    }

    DataView& DataView::setTitle(const std::string& newTitle)
    {
        title = newTitle;
        return *this;
    }

    const std::string& DataView::getStyle() const
    {
        return style;
    }

    DataView& DataView::setStyle(const std::string& newStyle)
    {
        styleID     = PlotStyle::Custom;
        styleFamily = PlotStyleFamily::Custom;
        style       = newStyle;
        return *this;
    }

    PlotStyleFamily DataView::getStyleFamily() const
    {
        return styleFamily;
    }

    DataView& DataView::setStyleFamily(PlotStyleFamily newStyleFamily)
    {
        if (styleID == PlotStyle::Custom)
        {
            styleFamily = newStyleFamily;
        }
        else
        {
            throw UnsupportedOperationError("Cannot override style family for non-custom plot style.");
        }

        return *this;
    }

    const PlotStyle DataView::getStyleID() const
    {
        return styleID;
    }

    DataView& DataView::setStyleID(const PlotStyle newStyle)
    {
        styleID     = newStyle;
        styleFamily = getPlotStyleFamily(newStyle);
        style       = getPlotStyleName(newStyle);
        return *this;
    }

    bool DataView::getBinaryDataOutput() const
    {
        return binaryDataOutput;
    }

    DataView& DataView::setBinaryDataOutput(bool newBinaryDataOutput)
    {
        binaryDataOutput = newBinaryDataOutput;
        return *this;
    }

    const std::string& DataView::getOptions() const
    {
        return options;
    }

    DataView& DataView::setOptions(const std::string& newOptions)
    {
        options = newOptions;
        return *this;
    }

    const std::string& DataView::getDataFilename() const
    {
        return dataFilename;
    }

    DataView& DataView::setDataFilename(const std::string& newDataFilename)
    {
        throwIfInvalidFilename("data output filename", newDataFilename);
        dataFilename = newDataFilename;
        return *this;
    }

    bool DataView::getAutoGenerateDataFilename() const
    {
        return autoGenerateDataFilename;
    }

    DataView& DataView::setAutoGenerateDataFilename(bool newAutoGenerateDataFilename)
    {
        autoGenerateDataFilename = newAutoGenerateDataFilename;
        return *this;
    }

    int DataView::getNumberPrecision() const
    {
        return numberPrecision;
    }

    DataView& DataView::setNumberPrecision(int newNumberPrecision)
    {
        numberPrecision = newNumberPrecision;
        return *this;
    }

    const std::string& DataView::getColumnSeparatorTxt() const
    {
        return columnSeparatorTxt;
    }

    DataView& DataView::setColumnSeparatorTxt(const std::string& newSeparatorTXT)
    {
        columnSeparatorTxt = newSeparatorTXT;
        return *this;
    }

    const std::string& DataView::getColumnSeparatorDat() const
    {
        return columnSeparatorDat;
    }

    DataView& DataView::setColumnSeparatorDat(const std::string& newSeparatorDAT)
    {
        columnSeparatorDat = newSeparatorDAT;
        return *this;
    }
}
